<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Book &amp; Notes Vault ‚Äî Validation Tests</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Source+Sans+Pro:wght@400;600;700&display=swap');

        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        body {
            font-family: 'Source Sans Pro', system-ui, sans-serif;
            background: #e8edf2;
            color: #333;
            padding: 2rem;
            line-height: 1.6;
        }

        h1 {
            font-size: 1.75rem;
            color: #1a5276;
            margin-bottom: 0.5rem;
        }

        .summary {
            font-size: 1.125rem;
            margin-bottom: 1.5rem;
            padding: 1rem;
            border-radius: 6px;
            font-weight: 600;
        }

        .summary.pass {
            background: #d4edda;
            color: #155724;
            border-left: 4px solid #27855a;
        }

        .summary.fail {
            background: #f8d7da;
            color: #721c24;
            border-left: 4px solid #c0392b;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            background: #fff;
            border: 1px solid #d4dbe4;
            border-radius: 6px;
            overflow: hidden;
        }

        th {
            background: #3d7a9e;
            color: #fff;
            text-align: left;
            padding: 0.75rem 1rem;
            font-size: 0.75rem;
            text-transform: uppercase;
            letter-spacing: 0.06em;
        }

        td {
            padding: 0.625rem 1rem;
            border-bottom: 1px solid #e2e7ed;
            font-size: 0.875rem;
            vertical-align: top;
        }

        tr:last-child td {
            border-bottom: none;
        }

        tr:hover {
            background: #f4f6f9;
        }

        .pass-icon {
            color: #27855a;
            font-weight: 700;
        }

        .fail-icon {
            color: #c0392b;
            font-weight: 700;
        }

        .rule-tag {
            display: inline-block;
            background: #f4f6f9;
            padding: 2px 8px;
            border-radius: 4px;
            font-size: 0.75rem;
            border: 1px solid #d4dbe4;
            font-style: italic;
        }
    </style>
</head>

<body>
    <h1>üìö Validation Test Suite</h1>
    <div id="summary" class="summary"></div>
    <table>
        <thead>
            <tr>
                <th>#</th>
                <th>Result</th>
                <th>Rule</th>
                <th>Input</th>
                <th>Expected</th>
                <th>Got</th>
            </tr>
        </thead>
        <tbody id="results"></tbody>
    </table>

    <script type="module">
        import {
            validateTitle,
            validateAuthor,
            validatePages,
            validateTag,
            validateDate,
            validateAll,
            PATTERNS,
        } from './scripts/validators.js';

        /* ========== Tiny assertion framework ========== */
        const results = [];

        function assert(description, rule, input, expected, actual) {
            const passed = expected === actual;
            results.push({ description, rule, input, expected, actual, passed });
        }

        /* ===================================================
           TEST CASES
           =================================================== */

        // ‚Äî‚Äî‚Äî TITLE: required ‚Äî‚Äî‚Äî
        assert('Empty title ‚Üí invalid',
            'required', '""', false, validateTitle('').valid);

        assert('Valid short title ‚Üí valid',
            'required', '"Algorithms"', true, validateTitle('Algorithms').valid);

        // ‚Äî‚Äî‚Äî TITLE: Regex 1 ‚Äî no leading/trailing whitespace ‚Äî‚Äî‚Äî
        assert('Leading space in title ‚Üí invalid',
            'Regex 1: trim', '" Hello"', false, validateTitle(' Hello').valid);

        assert('Trailing space in title ‚Üí invalid',
            'Regex 1: trim', '"Hello "', false, validateTitle('Hello ').valid);

        assert('Clean title ‚Üí valid',
            'Regex 1: trim', '"Hello World"', true, validateTitle('Hello World').valid);

        // ‚Äî‚Äî‚Äî TITLE: Regex 2 ‚Äî duplicate consecutive words (advanced back-ref) ‚Äî‚Äî‚Äî
        assert('Duplicate words "the the" ‚Üí invalid',
            'Regex 2: dupe (back-ref)', '"the the book"', false, validateTitle('the the book').valid);

        assert('Duplicate words "very very" ‚Üí invalid',
            'Regex 2: dupe (back-ref)', '"A very very long title"', false, validateTitle('A very very long title').valid);

        assert('No duplicate ‚Üí valid',
            'Regex 2: dupe (back-ref)', '"A very long title"', true, validateTitle('A very long title').valid);

        // ‚Äî‚Äî‚Äî TITLE: length ‚Äî‚Äî‚Äî
        assert('Title over 200 chars ‚Üí invalid',
            'length ‚â§ 200', '"A".repeat(201)', false, validateTitle('A'.repeat(201)).valid);

        assert('Title exactly 200 chars ‚Üí valid',
            'length ‚â§ 200', '"A".repeat(200)', true, validateTitle('A'.repeat(200)).valid);

        // ‚Äî‚Äî‚Äî AUTHOR: Regex 3 ‚Äî letters, spaces, hyphens ‚Äî‚Äî‚Äî
        assert('Valid author "Harper Lee" ‚Üí valid',
            'Regex 3: name', '"Harper Lee"', true, validateAuthor('Harper Lee').valid);

        assert('Author with hyphen "J-K Rowling" ‚Üí valid',
            'Regex 3: name', '"J-K Rowling"', true, validateAuthor('J-K Rowling').valid);

        assert('Author with number "Author1" ‚Üí invalid',
            'Regex 3: name', '"Author1"', false, validateAuthor('Author1').valid);

        assert('Author with special char "O\'Brien" ‚Üí invalid',
            'Regex 3: name', '"O\'Brien"', false, validateAuthor("O'Brien").valid);

        assert('Empty author ‚Üí invalid',
            'required', '""', false, validateAuthor('').valid);

        // ‚Äî‚Äî‚Äî PAGES: Regex 4 ‚Äî positive integer ‚Äî‚Äî‚Äî
        assert('Pages "250" ‚Üí valid',
            'Regex 4: pages', '"250"', true, validatePages('250').valid);

        assert('Pages "0" ‚Üí invalid',
            'Regex 4: pages', '"0"', false, validatePages('0').valid);

        assert('Pages "-5" ‚Üí invalid',
            'Regex 4: pages', '"-5"', false, validatePages('-5').valid);

        assert('Pages "3.14" ‚Üí invalid',
            'Regex 4: pages', '"3.14"', false, validatePages('3.14').valid);

        assert('Pages "" ‚Üí invalid',
            'required', '""', false, validatePages('').valid);

        // ‚Äî‚Äî‚Äî TAG: Regex 3 ‚Äî letters, spaces, hyphens ‚Äî‚Äî‚Äî
        assert('Tag "Computer Science" ‚Üí valid',
            'Regex 3: name', '"Computer Science"', true, validateTag('Computer Science').valid);

        assert('Tag "Sci-Fi" ‚Üí valid',
            'Regex 3: name', '"Sci-Fi"', true, validateTag('Sci-Fi').valid);

        assert('Tag with number "Tag2" ‚Üí invalid',
            'Regex 3: name', '"Tag2"', false, validateTag('Tag2').valid);

        assert('Empty tag ‚Üí invalid',
            'required', '""', false, validateTag('').valid);

        // ‚Äî‚Äî‚Äî DATE: Regex 5 ‚Äî YYYY-MM-DD ‚Äî‚Äî‚Äî
        assert('Date "2025-09-15" ‚Üí valid',
            'Regex 5: date', '"2025-09-15"', true, validateDate('2025-09-15').valid);

        assert('Date "2025-13-01" (month 13) ‚Üí invalid',
            'Regex 5: date', '"2025-13-01"', false, validateDate('2025-13-01').valid);

        assert('Date "2025-00-15" (month 00) ‚Üí invalid',
            'Regex 5: date', '"2025-00-15"', false, validateDate('2025-00-15').valid);

        assert('Date "09-15-2025" (US format) ‚Üí invalid',
            'Regex 5: date', '"09-15-2025"', false, validateDate('09-15-2025').valid);

        assert('Date "2025/09/15" (slashes) ‚Üí invalid',
            'Regex 5: date', '"2025/09/15"', false, validateDate('2025/09/15').valid);

        assert('Empty date ‚Üí invalid',
            'required', '""', false, validateDate('').valid);

        // ‚Äî‚Äî‚Äî validateAll ‚Äî batch ‚Äî‚Äî‚Äî
        assert('validateAll: all valid ‚Üí valid',
            'validateAll', '{all fields valid}', true,
            validateAll({
                title: 'Clean Title',
                author: 'Good Author',
                pages: '100',
                tag: 'Fiction',
                dateAdded: '2025-01-15',
            }).valid);

        assert('validateAll: bad title ‚Üí invalid',
            'validateAll', '{title: " bad"}', false,
            validateAll({
                title: ' bad',
                author: 'Good Author',
                pages: '100',
                tag: 'Fiction',
                dateAdded: '2025-01-15',
            }).valid);

        // ‚Äî‚Äî‚Äî Error message content check ‚Äî‚Äî‚Äî
        assert('Duplicate word error message mentions "duplicate"',
            'Regex 2: message', '"the the"', true,
            validateTitle('the the').message.toLowerCase().includes('duplicate'));

        assert('Author format error mentions "letters"',
            'Regex 3: message', '"Bad123"', true,
            validateAuthor('Bad123').message.toLowerCase().includes('letters'));

        /* ===================================================
           RENDER RESULTS
           =================================================== */
        const tbody = document.getElementById('results');
        let passCount = 0;
        let failCount = 0;

        results.forEach((r, i) => {
            if (r.passed) passCount++; else failCount++;
            const tr = document.createElement('tr');
            tr.innerHTML = `
        <td>${i + 1}</td>
        <td class="${r.passed ? 'pass-icon' : 'fail-icon'}">${r.passed ? '‚úÖ PASS' : '‚ùå FAIL'}</td>
        <td><span class="rule-tag">${r.rule}</span></td>
        <td>${r.input}</td>
        <td>${String(r.expected)}</td>
        <td>${String(r.actual)}</td>
      `;
            tbody.appendChild(tr);
        });

        const summaryEl = document.getElementById('summary');
        const allPassed = failCount === 0;
        summaryEl.className = `summary ${allPassed ? 'pass' : 'fail'}`;
        summaryEl.textContent = allPassed
            ? `‚úÖ All ${passCount} tests passed`
            : `‚ùå ${failCount} of ${passCount + failCount} tests failed`;
    </script>
</body>

</html>